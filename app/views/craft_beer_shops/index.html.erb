<h1>ã¿ã‚“ãªã®ğŸºæŠ•ç¨¿ä¸€è¦§</h1>

<div id="map" style="height: 400px;"></div>
<script>
  let map

  function initMap(){
    geocoder = new google.maps.Geocoder()

    map = new google.maps.Map(document.getElementById('map'), {
        center: {lat: 35.68123620000001, lng:139.7671248},
        zoom: 12,
    });


    <% @craft_beer_shops.each do |shop| %>
        (function(){
        var contentString = "ä½æ‰€ï¼š<%= shop.address %>";

        var marker = new google.maps.Marker({
            position:{lat: <%= shop.latitude %>, lng: <%= shop.longitude %>},
            map: map,
            title: contentString
        });

        })();
    <% end %>
    }
</script>

<script async defer src="https://maps.googleapis.com/maps/api/js?key=<%= ENV['GOOGLE_MAP_API_KEY'] %>&callback=initMap" type="text/javascript"></script>

<div class="contents">
  <p>ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼š<%= current_user.name %></p>
  <p><%= link_to "æ–°è¦æŠ•ç¨¿ã™ã‚‹", new_craft_beer_shop_path, class: 'btn btn-primary' %></p>
  <table class="table table-striped table-hover">
    <thead>
      <tr>
        <th scope="col">æŠ•ç¨¿ID</th>
        <th scope="col">å†™çœŸ</th>
        <th scope="col">ã‚¯ãƒ©ãƒ•ãƒˆãƒ“ãƒ¼ãƒ« åº—å</th>
        <th scope="col">ãŠã™ã™ã‚ãƒã‚¤ãƒ³ãƒˆ</th>
        <th scope="col">æŠ•ç¨¿æ—¥</th>
        <th scope="col">ã„ã„ã­</th>
        <th scope="col">ç·¨é›†</th>
        <th scope="col">å‰Šé™¤</th>
      </tr>
    </thead>
    <tbody>
      <% @craft_beer_shops.each do |craft_beer_shop| %>
        <tr>
          <th scope="row"><%= craft_beer_shop.id %></th>
          <% if craft_beer_shop.images.attached? %>
            <% image = craft_beer_shop.images.first %>
            <td><%= image_tag image, size: '70x60' %></td>
          <% else %>
            <td><%= image_tag "no_image.jpg", :size => '70x60', alt: "No Image" %></td>
          <% end %>
          <td><%=link_to "#{craft_beer_shop.name}", [craft_beer_shop] %></td>
          <td><%= craft_beer_shop.description.truncate(15) %></td>
          <td><%= l craft_beer_shop.created_at %></td>
          <td id="favorite_<%= craft_beer_shop.id %>">
            <%= render "favorites/favorite", craft_beer_shop: craft_beer_shop %>
          </td>
          <% if craft_beer_shop.user_id == current_user.id %>
            <td><%= link_to "ç·¨é›†", edit_craft_beer_shop_path(craft_beer_shop.id), class: "btn btn-sm btn-success" %></td>
            <td><%= link_to "å‰Šé™¤", craft_beer_shop, method: :delete, data: { confirm: "æœ¬å½“ã«å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ" }, class: "btn btn-sm btn-danger" %></td>
          <% else %>
          <td></td>
          <td></td>
          <% end %>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>
